<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="format-detection" content="telephone=no"/>
    <meta name="msapplication-tap-highlight" content="no"/>
    <meta name="viewport"
          content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width"/>
    <!-- This is a wide open CSP declaration. To lock this down for production, see below. -->
    <meta http-equiv="Content-Security-Policy"
          content="default-src * 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *"/>
    <title>Registro</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container-fluid">
    <form action="">
        <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
            <div class="panel panel-default">
                <div class="panel-heading" role="tab" id="headingOne">
                    <h4 class="panel-title">
                        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne"
                           aria-expanded="true" aria-controls="collapseOne">
                            Informacion Personal
                        </a>
                    </h4>
                </div>
                <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                    <div class="panel-body">
                        <div class="form-group">
                            <label for="name">Nombre</label>
                            <input type="text" class="form-control" id="name" placeholder="Nombre" name="name">
                        </div>
                        <div class="form-group">
                            <label for="lastname">Apellido</label>
                            <input type="text" class="form-control" id="lastname" placeholder="Apellido"
                                   name="lastname">
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" class="form-control" id="email" placeholder="Email" name="email">
                        </div>
                        <div class="form-group">
                            <label for="phone">Telefono</label>
                            <input type="text" class="form-control" id="phone" placeholder="Telefono" name="phone">
                        </div>
                        <div class="form-group">
                            <label for="birth_date">Fecha de Nacimiento</label>
                            <input type="date" class="form-control" id="birth_date" placeholder="Fecha de Nacimiento"
                                   name="birth_date">
                        </div>
                        <div class="form-group">
                            <label for="address">Direccion</label>
                            <input type="text" class="form-control" id="address" placeholder="Direccion" name="address">
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading" role="tab" id="headingTwo">
                    <h4 class="panel-title">
                        <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion"
                           href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                            Datos de Verificacion
                        </a>
                    </h4>
                </div>
                <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                    <div class="panel-body">
                        <div class="form-group">
                            <label for="rut">Rut</label>
                            <input type="text" class="form-control" id="rut" placeholder="Rut" name="rut" readonly>
                        </div>
                        <div class="form-group">
                            <label for="dni_number">Numero de Serie</label>
                            <input type="text" class="form-control" id="dni_number" placeholder="Numero de Serie"
                                   name="dni_number" readonly>
                        </div>
                        <a href="#" class="btn btn-info" onclick="barcoderead()">Valide su C.I</a>
                        <div class="form-group">
                            <label for="password">Contrasena</label>
                            <input type="text" class="form-control" id="password" placeholder="Contrasena"
                                   name="password">
                        </div>
                        <div class="form-group">
                            <label for="password2">Confirmacion de Contrasena</label>
                            <input type="text" class="form-control" id="password2" placeholder="Contrasena"
                                   name="password2">
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="sbif"> <a href="#" data-toggle="modal"
                                                                       data-target="#sbifModal">Nos autoriza a poder
                                utilizar su informacion en el Sbif (click para mas informacion)</a>
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="tyc"> <a href="#" data-toggle="modal"
                                                                      data-target="#tycModal">Accepta los Terminos y
                                Condiciones (click para mas informacion)</a>
                            </label>
                        </div>
                        <button class="btn btn-primary btn-lg btn-block">Registrarse</button>

                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="modal fade" id="sbifModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">Terminos y Conficiones del Sbif</h4>
            </div>
            <div class="modal-body">
                Al utilizar el aplicativo nos autoriza a nosotros como institucion poder acceder y utilizar su
                informacion del sbif...
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="tycModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">Terminos y Conficiones de Servicio</h4>
            </div>
            <div class="modal-body">
                Al acceptar esto nos permite a nosotros poder utilizar y manupular su infromacion, venta y/o transpaso
                de infromacion bancos.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="cordova.js"></script>
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script>
    function barcoderead() {
        cordova.plugins.barcodeScanner.scan(
            function (result) {
                console.log("We got a barcode\n" +
                    "Result: " + result.text + "\n" +
                    "Format: " + result.format + "\n" +
                    "Cancelled: " + result.cancelled);

                if (result.format == "QR_CODE") {
                    $.ajax({
                        type: "GET",
                        crossDomain: true,
                        url: result.text,
                        rejectUnauthorized: false,
                        success: function (data) {
                            parser = new DOMParser();
                            xmlDoc = parser.parseFromString(data, "text/xml");
                            var estado = xmlDoc.getElementsByClassName("setWidthOfSecondColumn")[0].innerHTML;
                            var dni_number = xmlDoc.getElementsByName("form:docNumber")[0].value;
                            var rut = xmlDoc.getElementsByName("form:run")[0].value;
                            var tipo = xmlDoc.getElementsByName("form:selectDocType")[0].value;
                            if (estado == "Vigente") {
                                if (tipo == "CEDULA") {
                                    $("#rut").val(rut);
                                    $("#dni_number").val(dni_number)
                                }
                                else {
                                    alert("Necesita Tener una Cedula de Identidad Chilena");
                                }
                            }
                            else {
                                alert("Su cedula no esta vigente, accerquese a el registro civil mas cercano a su domicilio.");
                            }
                        },
                        error:function (e) {
                            console.log(e)
                        }
                    });

                }
                else {
                    alert("proximamente");
                }


            },
            function (error) {
                alert("Scanning failed: " + error);
            },
            {
                preferFrontCamera: false, // iOS and Android
                showFlipCameraButton: false, // iOS and Android
                showTorchButton: true, // iOS and Android
                torchOn: false, // Android, launch with the torch switched on (if available)
                prompt: "Ponga el Carnet de Identidad en la Camara", // Android
                resultDisplayDuration: 500, // Android, display scanned text for X ms. 0 suppresses it entirely, default 1500
                formats: "QR_CODE,PDF_417", // default: all but PDF_417 and RSS_EXPANDED
                orientation: "portrait", // Android only (portrait|landscape), default unset so it rotates with the device
                disableAnimations: true, // iOS
                disableSuccessBeep: true // iOS
            }
        );
    }
</script>
</body>

</html>